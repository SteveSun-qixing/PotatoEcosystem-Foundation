# 薯片公共基础层 (Chips-Foundation)

**版本**: 1.0.0  
**更新时间**: 2026-01-31

---

## 概述

薯片公共基础层是整个薯片生态的基础设施,位于微内核之上,为所有软件和插件提供通用功能模块、运行环境和依赖库。这一层让生态内的插件和软件保持轻量化,避免重复开发,提高代码复用率。

### 架构定位

```
微内核 → 公共基础层 → 功能插件 → 软件产品
```

微内核提供中心路由、模块注册、生命周期管理。公共基础层提供通用组件和运行环境。功能插件实现业务逻辑。软件产品组合插件形成应用。

### 设计原则

- **高度解耦**: 每个模块独立开发和维护,通过标准接口对外提供服务
- **接口统一**: 所有模块使用统一的调用规范,通过微内核路由通信
- **职责单一**: 每个模块只负责一个核心功能,不包含业务逻辑
- **按需加载**: 模块在需要时才加载,减少启动时间和内存占用
- **轻量化**: 只包含通用必需的功能,使用成熟的开源库,不重复造轮子

---

## 模块清单

公共基础层包含 **26个核心模块**,分为7个功能分类:

### 核心运行环境 (3个)

| 模块 | 说明 | 需求文档 | 技术文档 |
|------|------|----------|----------|
| ChromiumCore | Chromium内核封装,提供网页渲染能力 | [需求文档](需求文档/核心环境-ChromiumCore-需求.md) | [技术文档](技术文档/核心环境-ChromiumCore-技术.md) |
| ElectronFramework | Electron框架,提供桌面应用能力 | [需求文档](需求文档/核心环境-ElectronFramework-需求.md) | [技术文档](技术文档/核心环境-ElectronFramework-技术.md) |
| RuntimeManager | 运行时管理器,管理模块生命周期 | [需求文档](需求文档/核心环境-RuntimeManager-需求.md) | [技术文档](技术文档/核心环境-RuntimeManager-技术.md) |

### 媒体组件 (4个)

| 模块 | 说明 | 需求文档 | 技术文档 |
|------|------|----------|----------|
| VideoPlayer | 视频播放器,支持多种视频格式 | [需求文档](需求文档/媒体-VideoPlayer-需求.md) | [技术文档](技术文档/媒体-VideoPlayer-技术.md) |
| AudioPlayer | 音频播放器,支持音频播放和波形显示 | [需求文档](需求文档/媒体-AudioPlayer-需求.md) | [技术文档](技术文档/媒体-AudioPlayer-技术.md) |
| ImageViewer | 图片查看器,支持图片显示、缩放、旋转 | [需求文档](需求文档/媒体-ImageViewer-需求.md) | [技术文档](技术文档/媒体-ImageViewer-技术.md) |
| Model3DRenderer | 3D模型渲染器,支持三维模型显示和交互 | [需求文档](需求文档/媒体-Model3DRenderer-需求.md) | [技术文档](技术文档/媒体-Model3DRenderer-技术.md) |

### 文本处理 (4个)

| 模块 | 说明 | 需求文档 | 技术文档 |
|------|------|----------|----------|
| RichTextRenderer | 富文本渲染器,解析和显示格式化文本 | [需求文档](需求文档/文本-RichTextRenderer-需求.md) | [技术文档](技术文档/文本-RichTextRenderer-技术.md) |
| MarkdownParser | Markdown解析器,将Markdown转换为HTML | [需求文档](需求文档/文本-MarkdownParser-需求.md) | [技术文档](技术文档/文本-MarkdownParser-技术.md) |
| CodeHighlighter | 代码高亮器,为多种编程语言提供语法高亮 | [需求文档](需求文档/文本-CodeHighlighter-需求.md) | [技术文档](技术文档/文本-CodeHighlighter-技术.md) |
| TextEditor | 文本编辑器,提供基础文本编辑功能 | [需求文档](需求文档/文本-TextEditor-需求.md) | [技术文档](技术文档/文本-TextEditor-技术.md) |

### 文件处理 (3个)

| 模块 | 说明 | 需求文档 | 技术文档 |
|------|------|----------|----------|
| ZIPProcessor | ZIP处理器,创建和解析卡片和箱子文件 | [需求文档](需求文档/文件-ZIPProcessor-需求.md) | [技术文档](技术文档/文件-ZIPProcessor-技术.md) |
| FileIdentifier | 文件识别器,判断文件类型 | [需求文档](需求文档/文件-FileIdentifier-需求.md) | [技术文档](技术文档/文件-FileIdentifier-技术.md) |
| FormatConverter | 格式转换器,提供常见格式转换 | [需求文档](需求文档/文件-FormatConverter-需求.md) | [技术文档](技术文档/文件-FormatConverter-技术.md) |

### 网络通信 (4个)

| 模块 | 说明 | 需求文档 | 技术文档 |
|------|------|----------|----------|
| HTTPClient | HTTP客户端,发送网络请求 | [需求文档](需求文档/网络-HTTPClient-需求.md) | [技术文档](技术文档/网络-HTTPClient-技术.md) |
| DownloadManager | 下载管理器,处理文件下载 | [需求文档](需求文档/网络-DownloadManager-需求.md) | [技术文档](技术文档/网络-DownloadManager-技术.md) |
| CacheManager | 缓存管理器,管理资源缓存 | [需求文档](需求文档/网络-CacheManager-需求.md) | [技术文档](技术文档/网络-CacheManager-技术.md) |
| ProtocolAdapter | 协议适配器,支持各种网络存储协议 | [需求文档](需求文档/网络-ProtocolAdapter-需求.md) | [技术文档](技术文档/网络-ProtocolAdapter-技术.md) |

### 界面组件 (4个)

| 模块 | 说明 | 需求文档 | 技术文档 |
|------|------|----------|----------|
| UIControls | 基础控件库,提供按钮、输入框等控件 | [需求文档](需求文档/界面-UIControls-需求.md) | [技术文档](技术文档/界面-UIControls-技术.md) |
| WindowManager | 窗口管理器,处理窗口操作 | [需求文档](需求文档/界面-WindowManager-需求.md) | [技术文档](技术文档/界面-WindowManager-技术.md) |
| DragDropSystem | 拖拽系统,处理拖动操作 | [需求文档](需求文档/界面-DragDropSystem-需求.md) | [技术文档](技术文档/界面-DragDropSystem-技术.md) |
| IFrameWrapper | 网页框架组件,封装iframe | [需求文档](需求文档/界面-IFrameWrapper-需求.md) | [技术文档](技术文档/界面-IFrameWrapper-技术.md) |

### 系统服务 (4个)

| 模块 | 说明 | 需求文档 | 技术文档 |
|------|------|----------|----------|
| DataSerializer | 数据序列化器,处理YAML和JSON | [需求文档](需求文档/系统-DataSerializer-需求.md) | [技术文档](技术文档/系统-DataSerializer-技术.md) |
| LogSystem | 日志系统,统一日志记录 | [需求文档](需求文档/系统-LogSystem-需求.md) | [技术文档](技术文档/系统-LogSystem-技术.md) |
| I18nSystem | 多语言系统,国际化支持 | [需求文档](需求文档/系统-I18nSystem-需求.md) | [技术文档](技术文档/系统-I18nSystem-技术.md) |
| ConfigManager | 配置管理器,配置读写和监听 | [需求文档](需求文档/系统-ConfigManager-需求.md) | [技术文档](技术文档/系统-ConfigManager-技术.md) |

---

## 文档结构

本项目的文档分为以下几类:

### 需求文档

位于 `需求文档/` 目录,每个模块对应一个需求文档。需求文档包含:

- **模块定位**: 模块在生态中的位置和作用
- **功能需求**: 模块应该实现的功能
- **接口需求**: 模块对外提供的接口
- **非功能需求**: 性能、稳定性、兼容性等要求

### 技术文档

位于 `技术文档/` 目录,每个模块对应一个技术文档。技术文档包含:

- **架构设计**: 模块的整体架构和设计思路
- **接口定义**: 接口的详细定义和参数说明
- **使用方式**: 如何调用和使用模块
- **技术细节**: 关键技术和实现细节

### 综合文档

- `01-架构设计.md`: 公共基础层的整体架构设计
- `02-模块清单.md`: 所有模块的简要说明
- `03-接口协议.md`: 模块间通信的协议规范
- `开发规范.md`: 开发公共基础层模块的规范

---

## 使用方式

### 调用模块

上层插件通过微内核的路由系统调用基础层模块:

```javascript
// 请求格式
const response = await Core.request({
  target: "模块名称",
  action: "操作名称",
  params: { /* 参数 */ }
});

// 响应格式
{
  success: true/false,
  data: { /* 数据 */ },
  error: { /* 错误信息 */ }
}
```

### 模块加载

模块采用按需加载机制,通过运行时管理器动态加载:

```javascript
// 加载模块
const moduleId = await RuntimeManager.loadModule('ModuleName');

// 使用模块
const result = await Core.request({
  target: 'ModuleName',
  action: 'doSomething',
  params: {}
});
```

---

## 开发规范

开发公共基础层模块时,必须遵循以下规范:

1. **中心路由**: 所有模块通信必须经过微内核路由
2. **接口统一**: 使用统一的请求响应格式
3. **模块独立**: 模块之间不直接调用,完全解耦
4. **按需加载**: 支持动态加载和卸载
5. **轻量化**: 只包含必需功能,不包含业务逻辑
6. **多语言**: 所有文本支持国际化
7. **配置化**: 所有可变参数通过配置管理
8. **日志记录**: 记录关键操作和错误
9. **错误处理**: 使用标准化的错误代码
10. **文档完整**: 提供完整的需求和技术文档

详细规范参见 [开发规范.md](开发规范.md)

---

## 版本管理

公共基础层作为整体有统一的版本号,所有模块一起发布。版本号遵循语义化版本规范:

- **主版本号**: 不兼容的API变更
- **次版本号**: 向后兼容的功能新增
- **修订号**: 向后兼容的问题修正

当前版本: **1.0.0**

---

## 依赖关系

公共基础层依赖以下开源库:

- **Chromium**: 网页渲染引擎
- **Electron**: 桌面应用框架
- **Three.js**: 3D渲染库
- **video.js**: 视频播放库
- **highlight.js**: 代码高亮库
- **marked**: Markdown解析库
- **JSZip**: ZIP文件处理库

所有依赖版本锁定在 `package.json` 中,确保稳定性。

---

## 贡献指南

欢迎为公共基础层贡献代码!请遵循以下流程:

1. Fork 本仓库
2. 创建特性分支
3. 实现功能并编写测试
4. 编写或更新文档
5. 提交 Pull Request

请确保:
- 代码通过所有测试
- 测试覆盖率达到80%以上
- 遵循开发规范
- 文档完整准确

---

## 许可证

MIT License

---

## 相关文档

- [薯片生态白皮书](../生态设计原稿（一切标准）/薯片生态白皮书（浓缩版）.md)
- [公共基础层设计](../生态设计原稿（一切标准）/32-公共基础层设计.md)
- [开发规范总则](../生态共用/08-开发规范总则.md)
- [插件开发规范](../生态共用/07-插件开发规范.md)

---

**维护团队**: 薯片生态核心团队  
**最后更新**: 2026-01-31
