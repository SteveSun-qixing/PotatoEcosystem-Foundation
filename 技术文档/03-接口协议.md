# 公共基础层 - 接口协议

## 模块调用协议

上层插件调用基础层模块时，使用统一的请求格式：

```
{
  target: "模块名称",
  action: "操作名称",
  params: { 参数对象 }
}
```

模块返回统一的响应格式：

```
{
  success: true/false,
  data: { 数据对象 },
  error: { 错误信息 }
}
```

所有调用都通过微内核路由，不允许直接调用模块。

## 资源访问协议

资源使用统一的标识符格式。本地文件使用文件路径，网络资源使用 URL，卡片内资源使用相对路径。

资源请求统一通过资源管理器，资源管理器根据标识符类型选择合适的获取方式，返回资源内容或资源句柄。

## 事件通知协议

模块通过事件总线发布事件，事件包含事件名称和事件数据。其他模块订阅事件，事件触发时收到通知。事件通过微内核的事件总线传递，模块之间不直接发送事件。

## 配置访问协议

配置通过配置管理器读写，使用点分隔的路径格式访问配置项。配置变更时，配置管理器通知订阅了该配置的模块。

## 日志记录协议

日志使用统一的日志接口，包含日志级别、日志消息、上下文信息。所有模块的日志都通过日志系统输出，日志系统负责格式化和存储。

## 错误处理协议

错误使用标准化的错误代码，包含错误类型、错误消息、详细信息。模块抛出的错误由微内核捕获，按统一格式返回给调用方。
