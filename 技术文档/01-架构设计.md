# 公共基础层 - 架构设计

## 整体架构

公共基础层采用模块化架构，每个功能模块独立封装。所有模块通过统一的接口对外提供服务，通过微内核的路由系统进行调用。

## 模块分类

### 核心环境层
- Chromium 内核封装
- Electron 框架集成
- 运行时管理

### 媒体处理层
- 视频播放模块
- 音频播放模块
- 图片处理模块
- 3D 渲染模块

### 文本处理层
- 富文本渲染模块
- Markdown 解析模块
- 代码高亮模块
- 文本编辑模块

### 文件系统层
- ZIP 处理模块
- 文件识别模块
- 格式转换模块

### 网络通信层
- HTTP 客户端模块
- 下载管理模块
- 缓存管理模块
- 协议适配模块

### 界面组件层
- 基础控件模块
- 窗口管理模块
- 拖拽系统模块
- 网页框架模块

### 系统服务层
- 数据序列化模块
- 日志系统模块
- 多语言模块
- 配置管理模块

## 模块通信

所有模块不直接相互调用，通过微内核路由。上层插件调用基础层模块时，请求发送到微内核，微内核路由到对应模块。模块返回结果也通过微内核转发。

## 接口规范

所有模块使用统一的接口格式：

- 请求格式统一
- 参数类型统一
- 返回值格式统一
- 错误处理统一

## 依赖管理

基础层依赖开源库实现核心功能。视频播放使用成熟的视频库，图片处理使用图像处理库，代码高亮使用现有高亮库。

依赖版本锁定，确保稳定性。定期更新依赖，获取安全补丁和性能优化。

## 版本控制

基础层整体版本号，所有模块统一发布。遵循语义化版本规范，主版本号表示破坏性更新，次版本号表示功能新增，修订号表示问题修复。

支持多版本共存，不同软件可以使用不同版本的基础层。

## 打包策略

支持按需打包，只打包实际使用的模块。软件制作器分析软件的功能需求，选择性打包基础层模块。

支持两种打包模式：完全独立打包（基础层打包到软件中）和共享模式（基础层在系统中共享）。
